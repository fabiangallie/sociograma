<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sociograma</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #f0f8ff, #e0ffe0);
      font-family: 'Segoe UI', sans-serif;
    }
    .container {
      min-height: 100vh;
      width: 100%;
      max-width: 1000px;
      margin: auto;
      padding: 2em 1em;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      background: white;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      border-radius: 12px;
    }
    .names-list, .selection-box {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1em;
      padding: 1em;
      margin: 1em auto;
      background: #f8faff;
      border-radius: 12px;
      border: 2px dashed #cce0ff;
      min-height: 120px;
      max-width: 700px;
    }
    .card {
      width: 100px;
      height: 100px;
      border-radius: 14px;
      background: linear-gradient(145deg, #e3f2fd, #ffffff);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 6px 12px rgba(0,0,0,0.08);
      font-size: 1em;
      cursor: grab;
      transition: transform 0.2s;
    }
    .card:hover {
      transform: scale(1.05);
      background: #d6eaff;
    }
    .icon {
      font-size: 2.5em;
    }
    button {
      font-size: 1.2em;
      padding: 0.8em 1.5em;
      margin-top: 1em;
      border-radius: 12px;
      background-color: #5dade2;
      color: white;
      border: none;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      cursor: pointer;
    }
    button:hover {
      background-color: #3498db;
      transform: translateY(-2px);
    }
    #informe {
      margin-top: 2em;
      padding: 1.5em;
      background: #ffffff;
      border-radius: 12px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      white-space: pre-wrap;
      border: 1px solid #ccc;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      font-size: 1.05em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="pregunta"></h2>
    <div class="names-list" id="lista-nombres"></div>
    <div class="selection-box" id="seleccion">Arrastra aquÃ­ tus elecciones (mÃ¡x. 3)</div>
    <button onclick="siguiente()">Siguiente</button>
    <div id="informe" style="display:none;"></div>
  </div>

  <script>
    const lang = localStorage.getItem('lang') || 'es';
    const preguntas = {
      es: [
        "Â¿Con quiÃ©n te gusta jugar en el recreo?",
        "Â¿Con quiÃ©n no te gusta jugar en el recreo?",
        "Â¿Con quiÃ©n te gusta trabajar en clase?",
        "Â¿Con quiÃ©n no te gusta trabajar en clase?"
      ],
      gl: [
        "Con quen che gusta xogar no recreo?",
        "Con quen non che gusta xogar no recreo?",
        "Con quen che gusta traballar na clase?",
        "Con quen non che gusta traballar na clase?"
      ]
    }[lang];

    const curso = localStorage.getItem("alumno_curso");
    const fecha = localStorage.getItem("alumno_fecha");
    const alumno = localStorage.getItem("alumno_nombre");
    const grupoKey = `grupo_${curso}_${fecha}`;
    const nombres = JSON.parse(localStorage.getItem(grupoKey)) || [];

    let paso = 0;
    const respuestas = [];

    const preguntaEl = document.getElementById("pregunta");
    const lista = document.getElementById("lista-nombres");
    const seleccion = document.getElementById("seleccion");
    const informe = document.getElementById("informe");

    function mezclarArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function cargarPregunta() {
      preguntaEl.textContent = preguntas[paso];
      lista.innerHTML = "";
      seleccion.innerHTML = lang === "gl"
        ? "Arrastra aquÃ­ as tÃºas elecciÃ³ns (mÃ¡x. 3)"
        : "Arrastra aquÃ­ tus elecciones (mÃ¡x. 3)";

      const opciones = mezclarArray([...nombres.filter(n => n !== alumno)]);
      opciones.forEach(nombre => {
        const card = document.createElement("div");
        card.className = "card";
        card.setAttribute("draggable", true);
        card.ondragstart = e => e.dataTransfer.setData("text", nombre);
        card.innerHTML = `<div class="icon">ðŸ‘¤</div><div>${nombre}</div>`;
        lista.appendChild(card);
      });
    }

    seleccion.ondragover = e => e.preventDefault();
    seleccion.ondrop = e => {
      e.preventDefault();
      const nombre = e.dataTransfer.getData("text");
      const yaEsta = [...seleccion.querySelectorAll(".card")].some(c => c.innerText.includes(nombre));
      if (!yaEsta && seleccion.querySelectorAll(".card").length < 3) {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<div class="icon">ðŸ‘¤</div><div>${nombre}</div>`;
        seleccion.appendChild(card);
      }
    };

    function siguiente() {
      const elegidos = [...seleccion.querySelectorAll(".card")].map(c => c.innerText.trim());
      respuestas.push({ pregunta: preguntas[paso], seleccionados: elegidos });
      paso++;
      if (paso < preguntas.length) {
        cargarPregunta();
      } else {
        mostrarInforme();
      }
    }

    function mostrarInforme() {
      document.querySelector("h2").textContent = lang === "gl" ? "Informe final" : "Informe final";
      lista.style.display = "none";
      seleccion.style.display = "none";
      document.querySelector("button").style.display = "none";

      let texto = `${lang === "gl" ? "Nome do alumno/a" : "Alumno/a"}: ${alumno}\nCurso: ${curso}\nData: ${fecha}\n\n${lang === "gl" ? "Respostas" : "Respuestas"}:\n`;
      respuestas.forEach(r => {
        texto += `\n${r.pregunta}\nâ†’ ${r.seleccionados.join(", ") || (lang === "gl" ? "NinguÃ©n" : "Ninguno")}\n`;
      });

      informe.innerText = texto;
      informe.style.display = "block";
    }

    cargarPregunta();
  </script>
</body>
</html>





