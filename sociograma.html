<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Test Sociométrico</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <div class="title-box azul">
      <h1 class="title-grande">Sociograma</h1>
    </div>

    <div id="bienvenida" class="form">
      <!-- Saludo personalizado al alumno -->
    </div>

    <form id="form-sociograma" class="form">
      <p>Selecciona a tus compañeros según se indica:</p>

      <label for="eleccion1">¿Con quién te gustaría trabajar en clase?</label>
      <select id="eleccion1" required>
        <option value="">-- Elegir compañero/a --</option>
      </select>

      <label for="eleccion2">¿Con quién te gustaría jugar en el recreo?</label>
      <select id="eleccion2" required>
        <option value="">-- Elegir compañero/a --</option>
      </select>

      <button type="submit" class="btn">Enviar respuestas</button>
    </form>
  </div>

  <script>
    const grupoClave = sessionStorage.getItem("grupoSeleccionado");
    const alumno = sessionStorage.getItem("alumnoSeleccionado");

    const bienvenida = document.getElementById("bienvenida");
    const eleccion1 = document.getElementById("eleccion1");
    const eleccion2 = document.getElementById("eleccion2");

    if (!grupoClave || !alumno) {
      alert("Datos no válidos. Vuelve a la pantalla anterior.");
      window.location.href = "acceso_alumno.html";
    } else {
      bienvenida.innerHTML = `<p><strong>Hola ${alumno}!</strong> Gracias por participar en el sociograma. A continuación responde con sinceridad.</p>`;

      const grupo = JSON.parse(localStorage.getItem(grupoClave));
      const compañeros = grupo.alumnos.filter(nombre => nombre !== alumno);

      compañeros.forEach(nombre => {
        const option1 = document.createElement("option");
        option1.value = nombre;
        option1.textContent = nombre;

        const option2 = option1.cloneNode(true);

        eleccion1.appendChild(option1);
        eleccion2.appendChild(option2);
      });
    }

    document.getElementById("form-sociograma").addEventListener("submit", function(e) {
      e.preventDefault();

      const respuesta = {
        alumno,
        eleccion1: eleccion1.value,
        eleccion2: eleccion2.value,
        fecha: new Date().toISOString()
      };

      // Guardar respuestas (aquí se puede guardar en localStorage o enviar a servidor)
      const claveRespuestas = `${grupoClave} - respuestas`;
      let respuestas = JSON.parse(localStorage.getItem(claveRespuestas)) || [];
      respuestas.push(respuesta);
      localStorage.setItem(claveRespuestas, JSON.stringify(respuestas));

      // Redirigir a pantalla de agradecimiento
      window.location.href = "agradecimiento.html";
    });
  </script>
</body>
</html>









